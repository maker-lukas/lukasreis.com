---

---
	
<p class="minimal-line"><span class="time-display"></span> · <span class="now-playing">Loading</span> · <span class="coded-today">Loading</span> coded today!</p>

<style>
	.minimal-line {
		font-size: 14px;
		color: #7550A1;
		border-left: 3px solid #7550A1;
		padding-left: 12px;
		margin-top: 20px;
	}

	:global(.now-playing a) {
		color: #7550A1 !important;
	}

	:global(.now-playing a:hover) {
		color: #A084C2 !important;
	}
</style>

<script>

	function updateTime() {
		const now = new Date();
		const timeStr = now.toLocaleTimeString('en-GB', { 
			hour: '2-digit', 
			minute: '2-digit',
			timeZone: 'Europe/Lisbon'
		});
		
		document.querySelectorAll('.time-display').forEach(el => {
			el.textContent = timeStr;
		});
	}

	updateTime();
	setInterval(updateTime, 1000);

	async function updateNowPlaying() {
		try {
			const res = await fetch('/api/now-playing', { cache: 'no-store' });
			const data = await res.json();
			const el = document.querySelector('.now-playing');
			if (!el) return;

			if (data.error) {
				el.innerHTML = 'Not available';
			} else if (data.nowPlaying) {
				el.innerHTML = `<a href="${data.songUrl}" target="_blank">${data.song}</a> - <a href="${data.artistUrl}" target="_blank">${data.artist}</a>`;
			} else {
				el.innerHTML = 'Nothing playing';
			}
		} catch {
			const el = document.querySelector('.now-playing');
			if (el) el.innerHTML = 'Not available';
		}
	}

	updateNowPlaying();
	setInterval(updateNowPlaying, 6000);

	async function codingStats() {
		try {
			const res = await fetch('/api/hackatime');
			const data = await res.json();
			const el = document.querySelector('.coded-today');
			if (!el) return;

			if (data.data?.human_readable_total) {
				el.textContent = data.data.human_readable_total.replace(/\s*\d+s/, '');
			} else {
				el.textContent = '0m';
			}
		} catch {
			const el = document.querySelector('.coded-today');
			if (el) el.textContent = '0m';
		}
	}

	codingStats();
	setInterval(codingStats, 5000);
	

</script>
